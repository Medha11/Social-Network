
{% extends 'second_base.html' %}

{% block second_content %}


<!-- Add question -->

<button type="button" class="pull-right btn btn-default btn-lg" data-toggle="modal" data-target="#question" ><strong>Ask</strong></button>
<br></br>
<br>

<div class="modal fade" id="question"  tabindex="-1" role="dialog" aria-labelledby="questionLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="questionLabel">???</h4>
      </div>
      <div class="modal-body">
        <form id="formform" method="post" action="{% url 'post' %}{{ id }}/0/">
          {% csrf_token %}
          <div class="form-group">
            <label for="title" class="control-label">Title:</label>
            <input type="text" class="form-control" id="title" name="title" autofocus required>
          </div>
          <input type="number" class="hidden" name="id" value="{{ id }}" required>
          <input type="text" class="hidden" name="type" value="question" required>
          <div class="form-group">
            <label for="Question" class="control-label">Question:</label>
            <textarea class="form-control" id="Question" name="Question" required></textarea>
          </div>

          <div class="checkbox">
            <label>
              <input type="checkbox" name="check"> Ask Anonymously
            </label>
          </div>

        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary" form="formform">Ask</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal for confirming delete -->

<div class="modal fade" id="delete"  tabindex="-1" role="dialog" aria-labelledby="deleteLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="deleteLabel">Are you sure????</h4>
      </div>

      <div class="modal-body">
          <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
        <a type="submit" class="btn btn-success" id="confirm">Yes</a>
      </div>
      
    </div>
  </div>
</div>




<!-- Current Questions -->

{% if questions %}

  {% for question in questions %}
    <div class="panel panel-default">
        
      <ul class="list-group">

         <div class="panel-header">
          {% if question.user.user == user %} <!-- Checking if question posted by current user -->

          <a data-url="{% url 'delete_post' %}q/{{ id }}/{{ question.id }}" type="button" class="close" data-toggle="modal" data-target="#delete" style="position:relative; right:10px; bottom:10px"> <span>&times;</span></a> <!-- Delete button -->

          {% endif %}
          <h2>  &nbsp;  {{ question.title }} </h2> 
          
        </div>

      
    
         
        <div id="collapse{{ question.id }}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body" style="background-color:transparent">
            
            {{ question.question|safe }}
            <br> <br>
              <li class="list-group-item" style="background-color:transparent">
                  <a href="{% url 'forum' %}{{ id }}/{{ question.id }}" class="btn btn-default btn-lg" >View Answers <span class="badge">{{ question.number_of_answers  }}</span></a>
                  <span class="pull-right" >  
                  {% if question.anonymous %}
                    <strong> Asked By: </strong> Anonymous <br>
                  {% else %}
                    <strong> Asked By: </strong> <a href="{% url 'profile' %}{{ question.user.user.username }}"> {{ question.user.user.get_full_name }} </a> <br>
                  {% endif %}
                    <strong> Asked At: </strong> {{ question.date  }}
                  </span>
              </li>
            
          </div>
        </div>
    </div>

  {% endfor %}

{% else %}
    <div class="alert alert-info" role="alert">
      <div class="row">
            &nbsp; &nbsp;<strong> Be the first one to ask!!!! </strong>
       </div>
    </div>
  
{% endif %}  
     
{% endblock %}


{% block script %}
<!-- Script to decide the attributes of the modal 
    We can use the same modal for posting both answers and comments
-->



<script>

$('#delete').on('show.bs.modal', function (e) {
  var button = $(e.relatedTarget); // Button that triggered the modal
  var url = button.data('url');
  var modal = $(this);
  modal.find('.modal-body a[id="confirm"]').attr('href', url);
});

</script>

{% endblock %}